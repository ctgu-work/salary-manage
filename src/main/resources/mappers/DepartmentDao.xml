<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ctgu.salary.dao.DepartmentDao">
    <insert id="addDepartment"
            parameterType="com.ctgu.salary.po.Department"
            useGeneratedKeys="true" keyProperty="departId">
		INSERT INTO
		department(depart_name,depart_type_id,depart_phone,fax,description,father_depart_id,establish_date)
		values(#{departName},#{departTypeId},#{departPhone},#{fax},#{description},#{fatherDepartId}
		,#{establishDate})
	</insert>


	<resultMap id="depart" type="com.ctgu.salary.dto.DepartmentDto">
		<id column="depart_id" property="departId" />
		<result column="depart_name" property="departName" />
		<result column="depart_type_id" property="departTypeId" />
		<result column="depart_phone" property="departPhone" />
		<result column="fax" property="fax" />
		<result column="description" property="description" />
		<result column="father_depart_id" property="fatherDepartId" />
		<result column="establish_date" property="establishDate" />
		<result column="type" property="type" />
		<result column="father_depart_name" property="fatherDepartName" />
	</resultMap>
	<select id="findAllDepartment" resultMap="depart">
		SELECT a.*,b.depart_name as father_depart_name, department_type.type
		FROM department a LEFT JOIN department b on a.father_depart_id = b.depart_id , department_type
		WHERE a.depart_type_id = department_type.depart_type_id order by establish_date desc
	</select>

</mapper>